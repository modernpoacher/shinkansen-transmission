"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getObject=getObject;exports.getArray=getArray;exports.getSchema=getSchema;exports.default=transform;exports.isObject=exports.isArray=void 0;var _common=require("../common");const isArray=v=>Array.isArray(v);exports.isArray=isArray;const isObject=v=>(v||false)instanceof Object&&!isArray(v);exports.isObject=isObject;function getObject(schema,uri,parentUri){const{properties={}}=schema;return Object.entries(properties).reduce((accumulator,[key,schema])=>{const schemaUri=(0,_common.getUri)(parentUri,key);if(uri===schemaUri)return schema;return accumulator;},{});}function getArray(schema,uri,parentUri){const{items=[]}=schema;return[].concat(items).reduce((accumulator,schema,index)=>{const schemaUri=(0,_common.getUri)(parentUri,index);if(uri===schemaUri)return schema;return accumulator;},[]);}function getSchema(schema={},uri,parentUri){const{type}=schema;switch(type){case'object':return getObject(schema,uri,parentUri);case'array':return getArray(schema,uri,parentUri);default:return schema;}}function transform(document,schema={},values={},params={},uri=(0,_common.getUri)(),parentUri=uri){if(isObject(document)){return Object.entries(document).reduce((accumulator,[key,value])=>{const schemaUri=(0,_common.getUri)(uri,key);return transform(value,getSchema(schema,schemaUri,uri),accumulator,params,schemaUri,uri);},values);}if(isArray(document)){return document.reduce((accumulator,value,index)=>{const schemaUri=(0,_common.getUri)(uri,index);return transform(value,getSchema(schema,schemaUri,uri),accumulator,params,schemaUri,uri);},values);}if((0,_common.hasEnum)(schema)){const items=(0,_common.getEnum)(schema);const index=items.findIndex(value=>document===value);return{...values,[uri]:String(index)};}return{...values,[uri]:String(document)};}