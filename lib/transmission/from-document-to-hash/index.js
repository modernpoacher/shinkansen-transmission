"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getObject=getObject;exports.getArray=getArray;exports.getSchema=getSchema;exports.default=transform;exports.isArray=exports.isObject=void 0;var _common=require("../common");const isObject=v=>(v||false)instanceof Object&&!isArray(v);exports.isObject=isObject;const isArray=v=>Array.isArray(v);exports.isArray=isArray;function getObject({properties={}},parentUri,uri){return Reflect.get(properties,Object.keys(properties).find(key=>{const schemaUri=(0,_common.getUri)(parentUri,key);return uri===schemaUri;}));}function getArray({items=[]},parentUri,uri){return Array.from(items).find((schema,index)=>{const schemaUri=(0,_common.getUri)(parentUri,index);return uri===schemaUri;});}function getSchema(schema={},parentUri,uri){const{type}=schema;switch(type){case'object':return getObject(schema,parentUri,uri);case'array':return getArray(schema,parentUri,uri);default:return schema;}}function transform(document,schema={},values={},params={},parentUri='#',uri=(0,_common.getUri)(parentUri)){if(isObject(document)){return Object.entries(document).reduce((values,[key,value])=>{const schemaUri=(0,_common.getUri)(parentUri,key);return transform(value,getSchema(schema,parentUri,schemaUri),values,params,schemaUri,schemaUri);},values);}if(isArray(document)){return document.reduce((values,value,index)=>{const schemaUri=(0,_common.getUri)(parentUri,index);return transform(value,getSchema(schema,parentUri,schemaUri),values,params,schemaUri,schemaUri);},values);}if((0,_common.hasEnum)(schema)){const items=(0,_common.getEnum)(schema);const index=items.findIndex(value=>document===value);return{...values,[uri]:String(index)};}return{...values,[uri]:String(document)};}