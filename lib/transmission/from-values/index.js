"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.transformObjectSchemaNull=transformObjectSchemaNull;exports.transformObjectSchemaBoolean=transformObjectSchemaBoolean;exports.transformObjectSchemaObject=transformObjectSchemaObject;exports.transformObjectSchemaArray=transformObjectSchemaArray;exports.transformObjectSchemaString=transformObjectSchemaString;exports.transformObjectSchemaNumber=transformObjectSchemaNumber;exports.transformObjectSchema=transformObjectSchema;exports.transformArraySchemaNull=transformArraySchemaNull;exports.transformArraySchemaBoolean=transformArraySchemaBoolean;exports.transformArraySchemaObject=transformArraySchemaObject;exports.transformArraySchemaArray=transformArraySchemaArray;exports.transformArraySchemaString=transformArraySchemaString;exports.transformArraySchemaNumber=transformArraySchemaNumber;exports.transformArraySchema=transformArraySchema;exports.transformNull=transformNull;exports.transformBoolean=transformBoolean;exports.transformObject=transformObject;exports.transformArray=transformArray;exports.transformString=transformString;exports.transformNumber=transformNumber;exports.default=transform;exports.toNumber=exports.toString=exports.toBoolean=exports.toNull=void 0;var _common=require("../common");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||Object.prototype.toString.call(arr)==="[object Arguments]")){return;}var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}var toNull=function toNull(v){if(v===null||v==='null')return null;throw new Error('Invalid `null`');};exports.toNull=toNull;var toBoolean=function toBoolean(v){if(typeof v==='boolean')return v;if(v==='true')return true;if(v==='false')return false;throw new Error('Invalid `boolean`');};exports.toBoolean=toBoolean;var toString=function toString(v){if(typeof v==='string')return v;if(typeof v==='number')return String(v);return JSON.stringify(v);};exports.toString=toString;var toNumber=function toNumber(v){if(typeof v==='number')return v;var n=Number(v);if(!isNaN(n))return n;throw new Error('Invalid `number`');};exports.toNumber=toNumber;function transformObjectSchemaNull(_ref,values){var parentUri=_ref.uri,fieldKey=_ref.key;var uri=(0,_common.getUri)(parentUri,fieldKey);if(Reflect.has(values,uri))return toNull(Reflect.get(values,uri));}function transformObjectSchemaBoolean(_ref2,values){var parentUri=_ref2.uri,fieldKey=_ref2.key;var uri=(0,_common.getUri)(parentUri,fieldKey);if(Reflect.has(values,uri))return toBoolean(Reflect.get(values,uri));}function transformObjectSchemaObject(_ref3,_ref4,values){var _ref3$properties=_ref3.properties,properties=_ref3$properties===void 0?{}:_ref3$properties;var parentUri=_ref4.uri,fieldKey=_ref4.key;var uri=(0,_common.getUri)(parentUri,fieldKey);return Object.entries(properties).reduce(function(accumulator,_ref5){var _ref6=_slicedToArray(_ref5,2),key=_ref6[0],schema=_ref6[1];return _objectSpread({},accumulator,_defineProperty({},key,transformObjectSchema(schema,{uri:uri,key:key},values)));},{});}function transformObjectSchemaArray(_ref7,_ref8,values){var _ref7$items=_ref7.items,items=_ref7$items===void 0?[]:_ref7$items;var parentUri=_ref8.uri,fieldKey=_ref8.key;var uri=(0,_common.getUri)(parentUri,fieldKey);return Object.keys(values).filter(function(key){return key.startsWith(uri);}).reduce(function(accumulator,key){var value=key.slice(uri.length+1);var index=Number(value.includes('/')?value.slice(0,value.indexOf('/')):value);if(!isNaN(index)){var schema=Array.isArray(items)?items[index]:items;accumulator[index]=transformArraySchema(schema,{uri:uri,index:index},values);}return accumulator;},[]);}function transformObjectSchemaString(_ref9,values){var parentUri=_ref9.uri,fieldKey=_ref9.key;var uri=(0,_common.getUri)(parentUri,fieldKey);if(Reflect.has(values,uri))return toString(Reflect.get(values,uri));}function transformObjectSchemaNumber(_ref10,values){var parentUri=_ref10.uri,fieldKey=_ref10.key;var uri=(0,_common.getUri)(parentUri,fieldKey);if(Reflect.has(values,uri))return toNumber(Reflect.get(values,uri));}function transformObjectSchema(){var schema=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var values=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var type=schema.type;switch(type){case'null':return transformObjectSchemaNull(params,values);case'boolean':return transformObjectSchemaBoolean(params,values);case'object':return transformObjectSchemaObject(schema,params,values);case'array':return transformObjectSchemaArray(schema,params,values);case'string':return transformObjectSchemaString(params,values);case'number':return transformObjectSchemaNumber(params,values);default:throw new Error('Schema does not conform to Instance Data Model, https://json-schema.org/draft/2019-09/json-schema-core.html#rfc.section.4.2.1');}}function transformArraySchemaNull(_ref11,values){var parentUri=_ref11.uri,arrayIndex=_ref11.index;var uri=(0,_common.getUri)(parentUri,arrayIndex);if(Reflect.has(values,uri))return toNull(Reflect.get(values,uri));}function transformArraySchemaBoolean(_ref12,values){var parentUri=_ref12.uri,arrayIndex=_ref12.index;var uri=(0,_common.getUri)(parentUri,arrayIndex);if(Reflect.has(values,uri))return toBoolean(Reflect.get(values,uri));}function transformArraySchemaObject(_ref13,_ref14,values){var _ref13$properties=_ref13.properties,properties=_ref13$properties===void 0?{}:_ref13$properties;var parentUri=_ref14.uri,arrayIndex=_ref14.index;var uri=(0,_common.getUri)(parentUri,arrayIndex);return Object.entries(properties).reduce(function(accumulator,_ref15){var _ref16=_slicedToArray(_ref15,2),key=_ref16[0],schema=_ref16[1];return _objectSpread({},accumulator,_defineProperty({},key,transformObjectSchema(schema,{uri:uri,key:key},values)));},{});}function transformArraySchemaArray(_ref17,_ref18,values){var _ref17$items=_ref17.items,items=_ref17$items===void 0?[]:_ref17$items;var parentUri=_ref18.uri,arrayIndex=_ref18.index;var uri=(0,_common.getUri)(parentUri,arrayIndex);return Object.keys(values).filter(function(key){return key.startsWith(uri);}).reduce(function(accumulator,key){var value=key.slice(uri.length+1);var index=Number(value.includes('/')?value.slice(0,value.indexOf('/')):value);if(!isNaN(index)){var schema=Array.isArray(items)?items[index]:items;accumulator[index]=transformArraySchema(schema,{uri:uri,index:index},values);}return accumulator;},[]);}function transformArraySchemaString(_ref19,values){var parentUri=_ref19.uri,arrayIndex=_ref19.index;var uri=(0,_common.getUri)(parentUri,arrayIndex);if(Reflect.has(values,uri))return toString(Reflect.get(values,uri));}function transformArraySchemaNumber(_ref20,values){var parentUri=_ref20.uri,arrayIndex=_ref20.index;var uri=(0,_common.getUri)(parentUri,arrayIndex);if(Reflect.has(values,uri))return toNumber(Reflect.get(values,uri));}function transformArraySchema(){var schema=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var values=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var type=schema.type;switch(type){case'null':return transformArraySchemaNull(params,values);case'boolean':return transformArraySchemaBoolean(params,values);case'object':return transformArraySchemaObject(schema,params,values);case'array':return transformArraySchemaArray(schema,params,values);case'string':return transformArraySchemaString(params,values);case'number':return transformArraySchemaNumber(params,values);default:throw new Error('Schema does not conform to Instance Data Model, https://json-schema.org/draft/2019-09/json-schema-core.html#rfc.section.4.2.1');}}function transformNull(values){var uri=(0,_common.getUri)();if(Reflect.has(values,uri))return toNull(Reflect.get(values,uri));}function transformBoolean(values){var uri=(0,_common.getUri)();if(Reflect.has(values,uri))return toBoolean(Reflect.get(values,uri));}function transformObject(_ref21,values){var _ref21$properties=_ref21.properties,properties=_ref21$properties===void 0?{}:_ref21$properties;var uri=(0,_common.getUri)();return Object.entries(properties).reduce(function(accumulator,_ref22){var _ref23=_slicedToArray(_ref22,2),key=_ref23[0],schema=_ref23[1];return _objectSpread({},accumulator,_defineProperty({},key,transformObjectSchema(schema,{uri:uri,key:key},values)));},{});}function transformArray(_ref24,values){var _ref24$items=_ref24.items,items=_ref24$items===void 0?[]:_ref24$items;var uri=(0,_common.getUri)();return Object.keys(values).filter(function(key){return key.startsWith(uri);}).reduce(function(accumulator,key){var value=key.slice(uri.length);var index=Number(value.includes('/')?value.slice(0,value.indexOf('/')):value);if(!isNaN(index)){var schema=Array.isArray(items)?items[index]:items;accumulator[index]=transformArraySchema(schema,{uri:uri,index:index},values);}return accumulator;},[]);}function transformString(values){var uri=(0,_common.getUri)();if(Reflect.has(values,uri))return toString(Reflect.get(values,uri));}function transformNumber(values){var uri=(0,_common.getUri)();if(Reflect.has(values,uri))return toNumber(Reflect.get(values,uri));}function transform(){var rootSchema=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var values=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var type=rootSchema.type;switch(type){case'null':return transformNull(values);case'boolean':return transformBoolean(values);case'object':return transformObject(rootSchema,values);case'array':return transformArray(rootSchema,values);case'number':return transformNumber(values);case'string':return transformString(values);default:throw new Error('Schema does not conform to Instance Data Model, https://json-schema.org/draft/2019-09/json-schema-core.html#rfc.section.4.2.1');}}