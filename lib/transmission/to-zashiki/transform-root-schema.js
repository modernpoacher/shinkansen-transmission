"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getRenderParamsForEnum=getRenderParamsForEnum;exports.getRenderParamsForAnyOf=getRenderParamsForAnyOf;exports.getRenderParamsForOneOf=getRenderParamsForOneOf;exports.getRenderParamsForAllOf=getRenderParamsForAllOf;exports.getRenderParamsForFields=getRenderParamsForFields;exports.getRenderParams=getRenderParams;exports.transformNullForEnum=transformNullForEnum;exports.transformNullForAnyOf=transformNullForAnyOf;exports.transformNullForOneOf=transformNullForOneOf;exports.transformNullForAllOf=transformNullForAllOf;exports.transformNull=transformNull;exports.transformBooleanForEnum=transformBooleanForEnum;exports.transformBooleanForAnyOf=transformBooleanForAnyOf;exports.transformBooleanForOneOf=transformBooleanForOneOf;exports.transformBooleanForAllOf=transformBooleanForAllOf;exports.transformBoolean=transformBoolean;exports.transformObjectForEnum=transformObjectForEnum;exports.transformObjectForAnyOf=transformObjectForAnyOf;exports.transformObjectForOneOf=transformObjectForOneOf;exports.transformObjectForAllOf=transformObjectForAllOf;exports.transformObject=transformObject;exports.transformArrayForEnum=transformArrayForEnum;exports.transformArrayForAnyOf=transformArrayForAnyOf;exports.transformArrayForOneOf=transformArrayForOneOf;exports.transformArrayForAllOf=transformArrayForAllOf;exports.transformArray=transformArray;exports.transformNumberForEnum=transformNumberForEnum;exports.transformNumberForAnyOf=transformNumberForAnyOf;exports.transformNumberForOneOf=transformNumberForOneOf;exports.transformNumberForAllOf=transformNumberForAllOf;exports.transformNumber=transformNumber;exports.transformStringForEnum=transformStringForEnum;exports.transformStringForAnyOf=transformStringForAnyOf;exports.transformStringForOneOf=transformStringForOneOf;exports.transformStringForAllOf=transformStringForAllOf;exports.transformString=transformString;exports.default=toZashiki;var _debug=_interopRequireDefault(require("debug"));var _common=require("../common");var _transformSchema=require("./transform-schema");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}const log=(0,_debug.default)('shinkansen-transmission:to-zashiki:root-schema');function getRenderParamsForEnum(rootSchema,values,params){log('getRenderParamsForEnum');const{parentUri='#',uri='#/',selectedItems=[],items=[]}=params;return{...params,parentUri,uri,[uri]:{meta:{...(0,_common.getMetaProps)(params,uri),schema:rootSchema,selectedItems},elements:{enum:{...(0,_common.getElementsFieldPropsForEnum)(params,uri),selectedItems,items}}}};}function getRenderParamsForAnyOf(rootSchema,values,params){log('getRenderParamsForAnyOf');const{parentUri='#',uri='#/',selectedItems=[],items=[]}=params;return{...params,parentUri,uri,[uri]:{meta:{...(0,_common.getMetaProps)(params,uri),schema:rootSchema,selectedItems},elements:{anyOf:{...(0,_common.getElementsFieldPropsForAnyOf)(params,uri),selectedItems,items}}}};}function getRenderParamsForOneOf(rootSchema,values,params){log('getRenderParamsForOneOf');const{parentUri='#',uri='#/',selectedItems=[],items=[]}=params;return{...params,parentUri,uri,[uri]:{meta:{...(0,_common.getMetaProps)(params,uri),schema:rootSchema,selectedItems},elements:{oneOf:{...(0,_common.getElementsFieldPropsForOneOf)(params,uri),selectedItems,items}}}};}function getRenderParamsForAllOf(rootSchema,values,params){log('getRenderParamsForAllOf');const{parentUri='#',uri='#/'}=params;return{...params,parentUri,uri,[uri]:{meta:{...(0,_common.getMetaProps)(params,uri),schema:rootSchema},elements:{field:{...(0,_common.getElementsFieldPropsForAllOf)(params,uri)}}}};}function getRenderParamsForFields(rootSchema,values,params){log('getRenderParamsForFields');const{parentUri='#',uri='#/',fields=[]}=params;return{...params,parentUri,uri,[uri]:{meta:{...(0,_common.getMetaProps)(params,uri),schema:rootSchema},elements:{...(0,_common.getElementsProps)(params,uri),fields}}};}function getRenderParams(rootSchema,values,params){log('getRenderParams');const{parentUri='#',uri='#/'}=params;return{...params,parentUri,uri,[uri]:{meta:{...(0,_common.getMetaProps)(params,uri),schema:rootSchema,parentUri:(0,_common.normaliseUri)(parentUri),uri},elements:(0,_common.getElementsProps)(params,uri)}};}function transformNullForEnum(rootSchema,values,params){log('transformNullForEnum');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const items=(0,_common.getEnum)(rootSchema);return(0,_transformSchema.renderNullForEnum)(rootSchema,values,getRenderParamsForEnum(rootSchema,values,{...params,selectedItems,items}));}function transformNullForAnyOf(rootSchema,values,params){log('transformNullForAnyOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{anyOf=[]}=rootSchema;const items=anyOf.map((0,_transformSchema.mapTransformNullByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderNullForAnyOf)(rootSchema,values,getRenderParamsForAnyOf(rootSchema,values,{...params,selectedItems,items}));}function transformNullForOneOf(rootSchema,values,params){log('transformNullForOneOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{oneOf=[]}=rootSchema;const items=oneOf.map((0,_transformSchema.mapTransformNullByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderNullForOneOf)(rootSchema,values,getRenderParamsForOneOf(rootSchema,values,{...params,selectedItems,items}));}function transformNullForAllOf(rootSchema,values,params){log('transformNullForAllOf');const{allOf=[],...rest}=rootSchema;const itemSchema=allOf.reduce((accumulator,schema)=>({...accumulator,...schema}),rest);return(0,_transformSchema.renderNullForAllOf)(itemSchema,values,getRenderParamsForAllOf(rootSchema,values,params));}function transformNull(rootSchema,values,params){log('transformNull');if((0,_common.hasEnum)(rootSchema)){return transformNullForEnum(rootSchema,values,params);}else{if((0,_common.hasAnyOf)(rootSchema)){return transformNullForAnyOf(rootSchema,values,params);}else{if((0,_common.hasOneOf)(rootSchema)){return transformNullForOneOf(rootSchema,values,params);}else{if((0,_common.hasAllOf)(rootSchema)){return transformNullForAllOf(rootSchema,values,params);}}}}return(0,_transformSchema.renderNull)(rootSchema,values,getRenderParams(rootSchema,values,params));}function transformBooleanForEnum(rootSchema,values,params){log('transformBooleanForEnum');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const items=(0,_common.getEnum)(rootSchema);return(0,_transformSchema.renderBooleanForEnum)(rootSchema,values,getRenderParamsForEnum(rootSchema,values,{...params,selectedItems,items}));}function transformBooleanForAnyOf(rootSchema,values,params){log('transformBooleanForAnyOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{anyOf=[]}=rootSchema;const items=anyOf.map((0,_transformSchema.mapTransformBooleanByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderBooleanForAnyOf)(rootSchema,values,getRenderParamsForAnyOf(rootSchema,values,{...params,selectedItems,items}));}function transformBooleanForOneOf(rootSchema,values,params){log('transformBooleanForOneOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{oneOf=[]}=rootSchema;const items=oneOf.map((0,_transformSchema.mapTransformBooleanByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderBooleanForOneOf)(rootSchema,values,getRenderParamsForOneOf(rootSchema,values,{...params,selectedItems,items}));}function transformBooleanForAllOf(rootSchema,values,params){log('transformBooleanForAllOf');const{allOf=[],...rest}=rootSchema;const itemSchema=allOf.reduce((accumulator,schema)=>({...accumulator,...schema}),rest);return(0,_transformSchema.renderBooleanForAllOf)(itemSchema,values,getRenderParamsForAllOf(rootSchema,values,params));}function transformBoolean(rootSchema,values,params){log('transformBoolean');if((0,_common.hasEnum)(rootSchema)){return transformBooleanForEnum(rootSchema,values,params);}else{if((0,_common.hasAnyOf)(rootSchema)){return transformBooleanForAnyOf(rootSchema,values,params);}else{if((0,_common.hasOneOf)(rootSchema)){return transformBooleanForOneOf(rootSchema,values,params);}else{if((0,_common.hasAllOf)(rootSchema)){return transformBooleanForAllOf(rootSchema,values,params);}}}}return(0,_transformSchema.renderBoolean)(rootSchema,values,getRenderParams(rootSchema,values,params));}function transformObjectForEnum(rootSchema,values,params){log('renderObjectForEnum');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const items=(0,_common.getEnum)(rootSchema);return(0,_transformSchema.renderObjectForEnum)(rootSchema,values,getRenderParamsForEnum(rootSchema,values,{...params,selectedItems,items}));}function transformObjectForAnyOf(rootSchema,values,params){log('transformObjectForAnyOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{anyOf=[]}=rootSchema;const items=anyOf.map((0,_transformSchema.mapTransformObjectByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderObjectForAnyOf)(rootSchema,values,getRenderParamsForAnyOf(rootSchema,values,{...params,selectedItems,items}));}function transformObjectForOneOf(rootSchema,values,params){log('transformObjectForOneOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{oneOf=[]}=rootSchema;const items=oneOf.map((0,_transformSchema.mapTransformObjectByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderObjectForOneOf)(rootSchema,values,getRenderParamsForOneOf(rootSchema,values,{...params,selectedItems,items}));}function transformObjectForAllOf(rootSchema,values,params){log('transformObjectForAllOf');const{allOf=[],...rest}=rootSchema;const itemSchema=allOf.reduce((accumulator,schema)=>({...accumulator,...schema}),rest);return(0,_transformSchema.renderObjectForAllOf)(itemSchema,values,getRenderParamsForAllOf(rootSchema,values,params));}function transformObject(rootSchema,values,params){log('transformObject');if((0,_common.hasEnum)(rootSchema)){return transformObjectForEnum(rootSchema,values,params);}else{if((0,_common.hasAnyOf)(rootSchema)){return transformObjectForAnyOf(rootSchema,values,params);}else{if((0,_common.hasOneOf)(rootSchema)){return transformObjectForOneOf(rootSchema,values,params);}else{if((0,_common.hasAllOf)(rootSchema)){return transformObjectForAllOf(rootSchema,values,params);}}}}const{uri='#/'}=params;const{properties={},required=[]}=rootSchema;const fields=Object.entries(properties).map((0,_transformSchema.mapTransformByKey)(rootSchema,values,{...params,parentUri:uri,required}));return(0,_transformSchema.renderObject)(rootSchema,values,getRenderParamsForFields(rootSchema,values,{...params,fields}));}function transformArrayForEnum(rootSchema,values,params){log('renderArrayForEnum');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const items=(0,_common.getEnum)(rootSchema);return(0,_transformSchema.renderArrayForEnum)(rootSchema,values,getRenderParamsForEnum(rootSchema,values,{...params,selectedItems,items}));}function transformArrayForAnyOf(rootSchema,values,params){log('transformArrayForAnyOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{anyOf=[]}=rootSchema;const items=anyOf.map((0,_transformSchema.mapTransformArrayByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderArrayForAnyOf)(rootSchema,values,getRenderParamsForAnyOf(rootSchema,values,{...params,selectedItems,items}));}function transformArrayForOneOf(rootSchema,values,params){log('transformArrayForOneOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{oneOf=[]}=rootSchema;const items=oneOf.map((0,_transformSchema.mapTransformArrayByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderArrayForOneOf)(rootSchema,values,getRenderParamsForOneOf(rootSchema,values,{...params,selectedItems,items}));}function transformArrayForAllOf(rootSchema,values,params){log('transformArrayForAllOf');const{allOf=[],...rest}=rootSchema;const itemSchema=allOf.reduce((accumulator,schema)=>({...accumulator,...schema}),rest);return(0,_transformSchema.renderArrayForAllOf)(itemSchema,values,getRenderParamsForAllOf(rootSchema,values,params));}function transformArray(rootSchema,values,params){log('transformArray');if((0,_common.hasEnum)(rootSchema)){return transformArrayForEnum(rootSchema,values,params);}else{if((0,_common.hasAnyOf)(rootSchema)){return transformArrayForAnyOf(rootSchema,values,params);}else{if((0,_common.hasOneOf)(rootSchema)){return transformArrayForOneOf(rootSchema,values,params);}else{if((0,_common.hasAllOf)(rootSchema)){return transformArrayForAllOf(rootSchema,values,params);}}}}const{items=[]}=rootSchema;if((0,_common.isArray)(items)){const fields=items.map((0,_transformSchema.mapTransformByIndex)(rootSchema,values,{...params,parentUri:'#'}));return(0,_transformSchema.renderArray)(rootSchema,values,getRenderParamsForFields(rootSchema,values,{...params,fields}));}else{if((0,_common.isObject)(items)){const fields=[(0,_transformSchema.getTransformByIndex)(items,rootSchema,values,{...params,parentUri:'#/'})];return(0,_transformSchema.renderArray)(rootSchema,values,getRenderParamsForFields(rootSchema,values,{...params,fields}));}}}function transformNumberForEnum(rootSchema,values,params){log('transformNumberForEnum');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const items=(0,_common.getEnum)(rootSchema);return(0,_transformSchema.renderNumberForEnum)(rootSchema,values,getRenderParamsForEnum(rootSchema,values,{...params,selectedItems,items}));}function transformNumberForAnyOf(rootSchema,values,params){log('transformNumberForAnyOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{anyOf=[]}=rootSchema;const items=anyOf.map((0,_transformSchema.mapTransformNumberByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderNumberForAnyOf)(rootSchema,values,getRenderParamsForAnyOf(rootSchema,values,{...params,selectedItems,items}));}function transformNumberForOneOf(rootSchema,values,params){log('transformNumberForOneOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{oneOf=[]}=rootSchema;const items=oneOf.map((0,_transformSchema.mapTransformNumberByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderNumberForOneOf)(rootSchema,values,getRenderParamsForOneOf(rootSchema,values,{...params,selectedItems,items}));}function transformNumberForAllOf(rootSchema,values,params){log('transformNumberForAllOf');const{allOf=[],...rest}=rootSchema;const itemSchema=allOf.reduce((accumulator,schema)=>({...accumulator,...schema}),rest);return(0,_transformSchema.renderNumberForAllOf)(itemSchema,values,getRenderParamsForAllOf(rootSchema,values,params));}function transformNumber(rootSchema,values,params){log('transformNumber');if((0,_common.hasEnum)(rootSchema)){return transformNumberForEnum(rootSchema,values,params);}else{if((0,_common.hasAnyOf)(rootSchema)){return transformNumberForAnyOf(rootSchema,values,params);}else{if((0,_common.hasOneOf)(rootSchema)){return transformNumberForOneOf(rootSchema,values,params);}else{if((0,_common.hasAllOf)(rootSchema)){return transformNumberForAllOf(rootSchema,values,params);}}}}return(0,_transformSchema.renderNumber)(rootSchema,values,getRenderParams(rootSchema,values,params));}function transformStringForEnum(rootSchema,values,params){log('transformStringForEnum');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const items=(0,_common.getEnum)(rootSchema);return(0,_transformSchema.renderStringForEnum)(rootSchema,values,getRenderParamsForEnum(rootSchema,values,{...params,selectedItems,items}));}function transformStringForAnyOf(rootSchema,values,params){log('transformStringForAnyOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{anyOf=[]}=rootSchema;const items=anyOf.map((0,_transformSchema.mapTransformStringByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderStringForAnyOf)(rootSchema,values,getRenderParamsForAnyOf(rootSchema,values,{...params,selectedItems,items}));}function transformStringForOneOf(rootSchema,values,params){log('transformStringForOneOf');const{parentUri='#',uri='#/'}=params;const{selectedItems=(0,_common.getSelectedItemsForUri)(values,parentUri,uri,rootSchema)}=(0,_common.getMetaProps)(params,uri);const{oneOf=[]}=rootSchema;const items=oneOf.map((0,_transformSchema.mapTransformStringByIndex)(rootSchema,values,{...params,selectedItems,parentUri:uri}));return(0,_transformSchema.renderStringForOneOf)(rootSchema,values,getRenderParamsForOneOf(rootSchema,values,{...params,selectedItems,items}));}function transformStringForAllOf(rootSchema,values,params){log('transformStringForAllOf');const{allOf=[],...rest}=rootSchema;const itemSchema=allOf.reduce((accumulator,schema)=>({...accumulator,...schema}),rest);return(0,_transformSchema.renderStringForAllOf)(itemSchema,values,getRenderParamsForAllOf(rootSchema,values,params));}function transformString(rootSchema,values,params){log('transformString');if((0,_common.hasEnum)(rootSchema)){return transformStringForEnum(rootSchema,values,params);}else{if((0,_common.hasAnyOf)(rootSchema)){return transformStringForAnyOf(rootSchema,values,params);}else{if((0,_common.hasOneOf)(rootSchema)){return transformStringForOneOf(rootSchema,values,params);}else{if((0,_common.hasAllOf)(rootSchema)){return transformStringForAllOf(rootSchema,values,params);}}}}return(0,_transformSchema.renderString)(rootSchema,values,getRenderParams(rootSchema,values,params));}function toZashiki(rootSchema={},values={},params={}){log('toZashiki');const{type}=rootSchema;switch(type){case'null':return transformNull(rootSchema,values,params);case'boolean':return transformBoolean(rootSchema,values,params);case'object':return transformObject(rootSchema,values,params);case'array':return transformArray(rootSchema,values,params);case'number':return transformNumber(rootSchema,values,params);case'string':return transformString(rootSchema,values,params);default:throw new Error('Schema does not conform to Instance Data Model, https://json-schema.org/draft/2019-09/json-schema-core.html#rfc.section.4.2.1');}}