"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getObject=getObject;exports.getArray=getArray;exports.getSchema=getSchema;exports.default=transform;exports.isObject=exports.isArray=void 0;var _common=require("../common");const isArray=v=>Array.isArray(v);exports.isArray=isArray;const isObject=v=>(v||false)instanceof Object&&!isArray(v);exports.isObject=isObject;function getObject(schema,uri,parentUri){const{properties={}}=schema;return Reflect.get(properties,Object.keys(properties).find(key=>{const schemaUri=(0,_common.getUri)(parentUri,key);return uri===schemaUri;}));}function getArray(schema,uri,parentUri){const{items=[]}=schema;return Array.from(items).find((schema,index)=>{const schemaUri=(0,_common.getUri)(parentUri,index);return uri===schemaUri;});}function getSchema(schema={},uri,parentUri){const{type}=schema;switch(type){case'object':return getObject(schema,uri,parentUri);case'array':return getArray(schema,uri,parentUri);default:return schema;}}function transform(document,schema={},values={},params={},parentUri='#',uri=(0,_common.getUri)(parentUri)){if(isObject(document)){return Object.entries(document).reduce((accumulator,[key,value])=>{const schemaUri=(0,_common.getUri)(parentUri,key);return transform(value,getSchema(schema,schemaUri,parentUri),accumulator,params,schemaUri,schemaUri);},values);}if(isArray(document)){return document.reduce((accumulator,value,index)=>{const schemaUri=(0,_common.getUri)(parentUri,index);return transform(value,getSchema(schema,schemaUri,parentUri),accumulator,params,schemaUri,schemaUri);},values);}if((0,_common.hasEnum)(schema)){const items=(0,_common.getEnum)(schema);const index=items.findIndex(value=>document===value);return{...values,[uri]:String(index)};}return{...values,[uri]:String(document)};}